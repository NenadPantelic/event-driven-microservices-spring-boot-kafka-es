# 1. Introduction to microservice architecture

# 1.1. Intro to microservice architecture

- microservice: scalable service with independent development and deployment
- microservice patterns:

  - externalized configuration -> Spring Cloud Config
  - API versioning
  - service discovery -> Eureka
  - API gateway -> Spring Cloud Gateway
  - Circuit breaker -> Spring Cloud Gateway & Resilience4j
  - Rate limiting -> Spring Cloud Gateway & Redis
  - Event sourcing -> Kafka
  - CQRS - Kafka & PostgreSQL & ElasticSearch
  - Authn/z with Ouath 2.0 and OIDC -> keycloak authn/z server
  - Monitoring -> Spring Boot actuator, Prometheus, Micrometer & Grafana
  - Distributed tracing, log aggregation and visualization -> Spring Clodu Sleuth, Zipkin, Elasticsearch, Logstash & Kibana

- Kafka - brokers, topics, partitions, producer, consumer, Spring Kafka
- ElasticSearch - Index API, Query API, Spring Elastic data
- Containerization with Docker
- Reactive development

* Eventual consistency - A consistency model used in distributed computing to achieve high availability that informally guarantees that, if no new updates are made to a given data item, eventually al accesses to that item will return the last updated value

- Data stream - continogous flow of data incrementally processed
- Kafka streams - a lib to build streaming apps, input and output data stored in Kafka, compute aggregation or join streams
- Event-driven microservices - subscribe to events generated by other services on Event store
- Config server - externalized application configuration service
- API gateway - reverse proxy between client and backend services. Applies filters and routes to backend.
- Discovery service - register and find services; provides network location, IP and port
- Keycloak server - Identity and Access Managemet, Single Sign-on (SSO)
- Oauth2 & Open ID connect -
  - Oauth2: delegated authorization with access token
  - OpenID connect (OIDC): Authentication with ID token

- Event sourcing - time ordered sequence of state changes
- Event-driven architecture - Reliable & Fault-tolerant & Scalable services; services are truly decoupled, asynchronous & non-blocking
- Event - a change of state on the system that can be recognized, reacted and processed
- ACID transactions - Atomicity, Consistency, Isolation and Durability
- Kafka - it stores events in immutable format and provides fast, reliable and scalable way of applying event-driven architecture. It can be used for large amount of streaming data that requires scaling and high throughput, it scales up well by partitioning topics (the data structure that holds the data), which makes the horizontal scaling easier. (RabbitMQ is usally meant to be vertically scaled); Topic can be viewed as a folder in a filesystem (they hold the real data) and the event are the files within that folder.
- Kafka replication - replicates data on different partitions on different nodes for resiliency
- REST communication - Synchronous HTTP protocol and blocking calls (can be problematic regarding the load, service blocking, timeouts, services are strictly coupled)

# 2. Spring Boot

- starters:
  - spring-boot-starter-web: Spring core, embedded tomcat, Spring MVC, Jackson, Logback
  - spring-boot-starter-test: JUnit, Spring test, Mockito
  - spring-boot-starter-actuator: Healthcheck, monitoring and metric endpoints
  - spring-boot-starter-security: Spring security config, web security
  - spring-cloud-starter-config: Spring cloud common, context, config-client
  - spring-boot-starter-oauth2-resource-server: Spring security core, Oauth2, jose
  - spring-boot-starter-thymeleaf: Template engine
  - spring-boot-starter-data-jpa: JDBC, Hibernate, Spring data
